!function(e){e.fn.imageMagnify=function(a){var o={debug:!1,log:function(e){console.log(e)},type:"magnifier",on:"mouseover"};a=e.extend(o,a),e(this).each(function(){function o(n){if(l||f){var t,s,d=i.offset(),g=n.pageX-d.left,h=n.pageY-d.top;if(t=g,s=h,g<i.width()&&h<i.height()&&g>0&&h>0?r.fadeIn(100):r.fadeOut(100),r.is(":visible")){var m,v,p,k,M,b=i.width(),y=i.height(),w=b/y,x=r.width(),C=r.height();"magnifier"===a.type?(w>c?(s=h+(b/c-y)/2,m=-1*Math.round(g/b*l-x/2),v=-1*Math.round(s/(b/c)*f-C/2)):w<c?(t=g+(y*c-b)/2,m=-1*Math.round(t/(y*c)*l-x/2),v=-1*Math.round(h/y*f-C/2)):w==c&&(m=-1*Math.round(g/b*l-x/2),v=-1*Math.round(h/y*f-C/2)),p=m+"px "+v+"px",k=g-x/2,M=h-C/2,r.css({left:k,top:M,backgroundPosition:p})):"magnify-inner"===a.type&&(w>c?(s=h+(b/c-y)/2,m=-1*Math.round(g/b*l-g/b*x),v=-1*Math.round(s/(b/c)*f-e(h/b)*C)):w<c?(t=g+(y*c-b)/2,m=-1*Math.round(t/(y*c)*l-g/b*x),v=-1*Math.round(h/y*f-h/b*C)):w==c&&(m=-1*Math.round(g/b*l-g/b*x),v=-1*Math.round(h/y*f-h/b*C)),m=m>0?0:m,v=v>0?0:v,p=(m=m<-(l-b)?-(l-b):m)+"px "+(v=v<-(f-y)?-(f-y):v)+"px",r.css({backgroundPosition:p}))}}else{var I=new Image;I.src=u,f=I.height,l=I.width,c=l/f,o(n)}}function n(){r.is(":visible")&&r.fadeOut(100)}var t,i=e(this),s=i.attr("data-image-src"),u=i.attr("data-magnify-src");t='<img class="small" src="'+s+'" alt="sourceImage"><div class="large" style="background-image:url('+u+')"></div>',i.append(t);i.find(".small");var c,r=i.find(".large"),l=0,f=0;switch(i.addClass(a.type),a.on){case"click":i.on("click",function(e){i.toggleClass("active"),i.hasClass("active")?(i.on("mousemove.click",o),i.on("mouseleave.click",n),o(e)):(i.off("mousemove.click",o),i.off("mouseleave.click",n),n())});break;case"toggle":i.on("click",function(e){i.toggleClass("active"),i.hasClass("active")?o(e):r.fadeOut(100)});break;case"grap":i.on("mousedown",function(e){i.on("mousemove.grap",o),i.on("mouseleave.grap",n),o(e),i.one("mouseup",function(){i.off("mousemove.grap",o),i.off("mouseleave.grap",n),n()})});break;default:i.on("mousemove",o),i.on("mouseleave",n)}})}}(jQuery);